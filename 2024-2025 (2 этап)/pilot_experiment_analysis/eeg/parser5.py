# -*- coding: utf-8 -*-
"""parser5.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/13vkPM9zrK1cm69cAfDTC22J8-Hgwj_Zs
"""

def process_file(input_file, output_file, substring_dict):
    with open(input_file, 'r', encoding='utf-8') as infile, open(output_file, 'w', encoding='utf-8') as outfile:
        for line in infile:

            parts = line.strip().split('\t')
            new_line = line
            if len(parts) < 2:
                outfile.write(new_line)
                continue

            id = parts[2].strip()
            stroka = parts[3].strip()

            for substring, new_id in substring_dict.items():
                if substring in stroka:
                    print(stroka, id, new_id)
                    new_line = line.replace(id, new_id)
                    replaced = True
                    print(new_line)
                    break

            # Если не нашли подходящую подстроку, оставляем id без изменений
            outfile.write(new_line)


# Пример использования
input_file = 'modified_11005-Main_text.txt'
output_file = '11005-Main_text.txt'
substring_dict = {
'nonecb0' : '110',
'nonecb1' : '111',
'nonecb2' : '112',
'ponecb0' : '210',
'ponecb1' : '211',
'ponecb2' : '212',
'ntwocb0' : '120',
'ntwocb1' : '121',
'ntwocb2' : '122',
'ptwocb0' : '220',
'ptwocb1' : '221',
'ptwocb2' : '222',
'nthreecb0' : '130',
'nthreecb1' : '131',
'nthreecb2' : '132',
'pthreecb0' : '230',
'pthreecb1' : '231',
'pthreecb2' : '232',
'tarcb1cbv1du1' : '51',
'tarcb1cbv1du2' : '52',
'tarcb1cbv1du3' : '53',
'tarcb1cbv2du1' : '61',
'tarcb1cbv2du2' : '62',
'tarcb1cbv2du3' : '63',
'tarcb2cbv1du1' : '71',
'tarcb2cbv1du2' : '72',
'tarcb2cbv1du3' : '73',
'tarcb2cbv2du1' : '81',
'tarcb2cbv2du2' : '82',
'tarcb2cbv2du3' : '83',
'tarcb0cbv0du1' : '91',
'tarcb0cbv0du2' : '92',
'tarcb0cbv0du3' : '93',
'tarcb0cbv0du1' : '11',
'tarcb0cbv0du2' : '12',
'tarcb0cbv0du3' : '13',
}

process_file(input_file, output_file, substring_dict)